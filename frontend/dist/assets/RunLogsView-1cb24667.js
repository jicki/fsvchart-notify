import{d as k,r as c,w as p,o as y,a as w,c as t,b as s,t as a,e as x,v as C,f as m,F as V,g as L,h as I,i as n,n as R,j as v,_ as T}from"./index-6a5a53be.js";const B={class:"tab-content"},D={class:"header"},N={class:"controls"},S=["disabled"],q={key:0,class:"loading"},F={key:1,class:"error"},M={key:2,class:"empty"},U={key:3,class:"records"},j={class:"record-time"},z={class:"record-task"},E={class:"record-status"},H={class:"record-message"},W={class:"record-detail"},A={key:0},G={key:1},J={key:2},K={key:3},O=["href"],P=k({__name:"RunLogsView",setup(Q){const d=c([]),i=c(!1),_=c(""),f=c(!1),r=c(null);let u=null;async function h(){i.value=!0,_.value="";try{d.value=await I("/api/send_records"),r.value&&setTimeout(()=>{r.value&&(r.value.scrollTop=r.value.scrollHeight)},100)}catch(o){_.value=o.message}finally{i.value=!1}}p(f,o=>{o?u=window.setInterval(h,5e3):u&&clearInterval(u)}),y(()=>{h()}),w(()=>{u&&clearInterval(u)});function g(o){return new Date(o).toLocaleString()}function b(o){switch(o.toLowerCase()){case"success":return"success";case"failed":return"error";case"pending":return"pending";default:return""}}return(o,l)=>(n(),t("div",B,[s("div",D,[l[2]||(l[2]=s("h3",null,"发送记录",-1)),s("div",N,[s("button",{onClick:h,disabled:i.value},a(i.value?"加载中...":"刷新记录"),9,S),s("label",null,[x(s("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e)},null,512),[[C,f.value]]),l[1]||(l[1]=m(" 自动刷新 "))])])]),s("div",{class:"records-container",ref_key:"recordsContainer",ref:r},[i.value?(n(),t("div",q,"加载中...")):_.value?(n(),t("div",F,a(_.value),1)):!d.value||d.value.length===0?(n(),t("div",M,"暂无记录")):(n(),t("div",U,[(n(!0),t(V,null,L(d.value,e=>(n(),t("div",{key:e.id,class:R(["record-entry",b(e.status)])},[s("div",j,a(g(e.timestamp)),1),s("div",z,a(e.task_name||"未命名任务"),1),s("div",E,a(e.status),1),s("div",H,a(e.message),1),s("div",W,[s("div",null,"Webhook: "+a(e.webhook),1),e.query?(n(),t("div",A,"查询: "+a(e.query),1)):v("",!0),e.time_range?(n(),t("div",G,"时间范围: "+a(e.time_range),1)):v("",!0),e.button_text?(n(),t("div",J,"按钮文本: "+a(e.button_text),1)):v("",!0),e.button_url?(n(),t("div",K,[l[3]||(l[3]=m(" 按钮链接: ")),s("a",{href:e.button_url,target:"_blank",class:"button-link"},a(e.button_url),9,O)])):v("",!0)])],2))),128))]))],512)]))}});const Y=T(P,[["__scopeId","data-v-b2ceba94"]]);export{Y as default};
